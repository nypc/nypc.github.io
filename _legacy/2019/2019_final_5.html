<!DOCTYPE html>
<html>
<head>
    <title>
    </title>
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <style>
        h1 { margin-bottom: 20pt; font-size: 22pt; font-weight: bold; }
        h2 { margin-top: 20pt; font-size: 16pt; font-weight: bold; }
        h3 { margin-top: 20pt; font-size: 14pt; font-weight: bold; }
        blockquote { font-size: 11pt; }
        </style>
</head>
<body style='padding:20pt; font-family: 맑은 고딕;'>
<a href='./'>← 목록으로</a>
<hr>
<!--------------->
<h1 id="회의">회의</h1>
<p>배찌의 회사는 N개의 건물과 N-1개의 도로로 이루어져 있다. 편의를 위해서, 건물에 1번부터 N번까지, 도로에 1번부터 N-1번까지 번호를 매기자. 도로 i는 건물 A<sub>i</sub>와 건물 B<sub>i</sub>를 양방향으로 연결하고, 길이는 C<sub>i</sub> 미터 이다. 배찌의 회사에 있는 임의의 두 건물에 대해서, 한 개 이상의 도로를 사용하여 두 건물을 서로 오갈 수 있다.</p>
<p>배찌의 회사에서는 큰 회의를 할 건물 D를 정하려고 한다. 회의에는 사람이 M명 참석하고, M명의 사람 중 i번째 사람은 처음에 건물 S<sub>i</sub>에 있다가 회의가 끝나면 건물 E<sub>i</sub>로 돌아간다. 또한, i번째 사람은 V<sub>i</sub>초에 1미터를 움직일 수 있다. 회의를 할 때는 각 사람은 건물 S<sub>i</sub>에서 건물 D까지 갔다가, 회의가 끝난 이후에 건물 D에서 건물 E<sub>i</sub>으로 돌아간다. 즉, i번째 사람의 이동시간은 V<sub>i</sub>×{(건물 S<sub>i</sub>과 건물 D의 최단거리) + (건물 D과 건물 E<sub>i</sub>의 최단거리)}로 계산할 수 있다.</p>
<p>배찌의 회사는 효율을 중요시 여기기 때문에 각 사람이 이동하는 데 드는 시간의 합을 최소화하도록 건물 D를 정하고 싶다. 각 사람이 이동하는 데 드는 시간의 합이 최소가 되는 건물 D를 구하여라.</p>
<h2 id="입력-형식">입력 형식</h2>
<p>첫째 줄에는 건물의 개수 N이 주어진다. (1 ≤ N ≤ 100,000)</p>
<p>다음 N-1개의 줄의 i번째 줄에는 도로 양 끝 도시와, 길이 정보를 나타내는 세 정수 A<sub>i</sub>,  B<sub>i</sub>,  C<sub>i</sub>이 공백으로 구분되어 주어진다. (1 ≤ A<sub>i</sub>,  B<sub>i</sub> ≤ N, 1 ≤ C<sub>i</sub> ≤ 1,000)</p>
<p>그 다음 줄에는 회의에 참석하는 사람의 수 M이 주어진다. (1 ≤ M ≤ 100,000)</p>
<p>다음 M개의 줄의 i번째 줄에는 회의를 하는 사람의 시작 건물, 도착 건물과 속도 정보를 나타내는 세 정수 S<sub>i</sub>, E<sub>i</sub>,  V<sub>i</sub>가 주어진다. (1 ≤ S<sub>i</sub>,  E<sub>i</sub> ≤ N, 1 ≤ V<sub>i</sub> ≤ 1,000)</p>
<p>배찌의 회사에 있는 임의의 두 건물에 대해서, 한 개 이상의 도로를 사용하여 두 건물을 서로 오갈 수 있다.</p>
<h2 id="출력-형식">출력 형식</h2>
<p>첫째 줄에 정수 D를 출력하여라. 이는, 각 사람이 이동하는데 드는 시간의 합이 최소가 되는 회의 장소가 건물 D라는 의미이다. 답이 여러개인 경우 아무거나 출력하여도 좋다.</p>
<h2 id="입력-예제">입력 예제</h2>
<pre><code>4
2 1 3
2 3 5
2 4 7
3
4 2 1
2 3 2
3 4 3</code></pre><h2 id="출력-예제">출력 예제</h2>
<pre><code>2</code></pre><h2 id="예제-설명">예제 설명</h2>
<p>1, 2, 3, 4번 건물에서 회의를 하는데 드는 각 사람의 시간 총 합은 89, 53, 63, 81이다.
2번 건물에서 회의를 하는게 각 사람의 시간 총 합이 최소가 됨을 알 수 있다.</p>
<h2 id="채점-방식">채점 방식</h2>
<p>입력 케이스들은 다음과 같은 종류로 구별되며, 한 종류의 케이스를 다 맞추어야 그 종류에 배정된 점수를 받을 수 있다.</p>
<ul>
<li>종류 1 (19점): N, M ≤ 100</li>
<li>종류 2 (16점): N, M ≤ 2000</li>
<li>종류 3 (26점): S<sub>i</sub> = E<sub>i</sub></li>
<li>종류 4 (18점): A<sub>i</sub> = i, B<sub>i</sub> = i+1</li>
<li>종류 5 (21점): 별다른 제약조건 없음. </li>
</ul>
<!--------------->
<h2>해설</h2>
<p><button onclick='document.getElementById("hint_text").style.display="block"; this.style.display="none";' class='btn btn-default'>펼치기</button></p> 
<div id='hint_text' style='display: none;'> 
하나의 도시에서 회의를 할 때 이동하는데 드는 시간의 합은 쉽게 깊이 우선 탐색 등을 통해 계산할 수 있다. 그 후, 인접한 건물로 옮겨가면서 변화값을 빠르게 계산해 주는 것으로 문제를 풀 수 있다. 또한, 이 문제를 매우 짧게 해결할 수 있는 좋은 아이디어도 존재한다.
</div> 
</body>
</html>