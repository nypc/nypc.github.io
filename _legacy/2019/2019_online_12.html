<!DOCTYPE html>
<html>
<head>
    <title>
    </title>
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <style>
        h1 { margin-bottom: 20pt; font-size: 22pt; font-weight: bold; }
        h2 { margin-top: 20pt; font-size: 16pt; font-weight: bold; }
        h3 { margin-top: 20pt; font-size: 14pt; font-weight: bold; }
        blockquote { font-size: 11pt; }
        </style>
</head>
<body style='padding:20pt; font-family: 맑은 고딕;'>
<a href='./'>← 목록으로</a>
<hr>
<!--------------->
<h1 id="메이플스토리-연주회">메이플스토리 연주회</h1>
<p>메이플스토리에는 여러 종류의 몬스터들이 있다. 그리고 이번 여름을 맞이하여 몬스터들이 모여 연주회를 하기로 하였다. 이를 위해 여러 종류의 몬스터 중 N개 종류의 몬스터들이 선별되었는데 i번째 몬스터의 울음소리는 알파벳 대문자로 구성된 문자열 S<sub>i</sub>로 표현된다.</p>
<p>에반은 선별된 몬스터들과 함께 연주를 진행하려 한다. 연주는 각 몬스터가 임의의 순서대로 울음소리를 내는 것이다. 에반이 연주하려는 완성된 노래는 알파벳 대문자로 구성된 문자열 P로 표현이 된다. 노래를 만들어가던 에반은 문득 자신이 선별한 몬스터들이 이 곡을 연주할 수 있는 모든 경우의 수가 몇 가지가 될지 궁금해졌다.</p>
<p>예를 들어 선별한 몬스터가 리본돼지, 주황버섯, 슬라임으로 구성되어 있고, 리본돼지의 울음소리는 ABCA, 주황버섯의 울음소리는 AB, 슬라임의 울음소리는 CA라 한다면,
ABABCA는 (주황버섯 - 주황버섯 - 슬라임) 혹은 (주황버섯 - 리본돼지)로 두 가지 표현이 가능하다.</p>
<p>이 때 주의할 점은 각 몬스터의 각 울음 소리의 문자들은 섞이지 않는다. 예를 들면 리본돼지(ABCA)가 울고, 주황버섯(AB)이 울면, ABCAAB이지, ABCABA 처럼 하나의 울음소리가 쪼개져 다른 울음소리와 섞일 수는 없다.</p>
<p>에반이 원하는 노래의 정보가 주어졌을 때, 선별한 몬스터들의 울음소리를 잘 조합해서 주어진 노래를 연주할 수 있는 모든 경우의 수를 구하자.</p>
<h2 id="입력-형식">입력 형식</h2>
<p>첫 줄에는 몬스터들의 종류 수를 나타내는 정수 N이 입력으로 주어진다. (1 ≤ N ≤ 100,000)</p>
<p>i+1번째 줄에는 i번째 몬스터의 울음소리인 알파벳 대문자로 구성된 문자열 S<sub>i</sub>가 입력으로 주어진다. (1 ≤ i ≤ N; 1 ≤ S<sub>i</sub>의 길이 ≤ 200,000; N ≤ 모든 S<sub>i</sub> 길이의 합 ≤ 200,000)</p>
<p>N+2번째 줄에는 연주하려는 곡의 정보인 알파벳 대문자로 구성된 문자열 P가 입력으로 주어진다. (1 ≤ P의 길이 ≤ 200,000)</p>
<h2 id="출력-형식">출력 형식</h2>
<p>첫 번째 줄에 선별한 몬스터들의 울음소리를 잘 조합해서 주어진 노래를 연주할 수 있는 경우의 수를 1,000,000,007(10<sup>9</sup>+7)로 나눈 나머지를 출력하라.</p>
<h2 id="입력-예제-1">입력 예제 1</h2>
<pre><code>3
ABCA
AB
CA
ABABCA</code></pre><h2 id="출력-예제-1">출력 예제 1</h2>
<pre><code>2</code></pre><h2 id="입력-예제-2">입력 예제 2</h2>
<pre><code>3
A
AA
AAA
AAAA</code></pre><h2 id="출력-예제-2">출력 예제 2</h2>
<pre><code>7</code></pre><h2 id="채점-방식">채점 방식</h2>
<p>입력 케이스들은 다음과 같은 종류로 구별되며, 한 종류의 케이스를 다 맞추어야 그 종류에 배정된 점수를 받을 수 있다.</p>
<ul>
<li>종류 1 (23점): N, 모든 S<sub>i</sub> 길이의 합, P의 길이 ≤ 1,000 </li>
<li>종류 2 (42점): N x (P의 길이) ≤ 1,000,000</li>
<li>종류 3 (35점): 별다른 제약조건 없음.</li>
</ul>

<!--------------->
<h2>해설</h2>
<p><button onclick='document.getElementById("hint_text").style.display="block"; this.style.display="none";' class='btn btn-default'>펼치기</button></p> 
<div id='hint_text' style='display: none;'> 
N마리 몬스터의 울음소리 문자열이 주어졌을 때, 전체 노래를 울음소리를 조합해서 표현하는 경우의 수를 구하는 문제이다.  N마리 몬스터의 울음소리 문자열로 Aho-Corasick Trie를 만든 후, 각 문자열의 끝 정점들을 색칠해두고, Trie의 각 정점에 대해 실패함수를 따라갈 때 최초로 만나는 색칠된 정점을 계산해두면, 색칠된 정점의 depth가 최대 sqrt(울음소리 문자열 길이의 총 합)이기 때문에 동적계획법으로 경우의 수를 구할 수 있게 된다.
</div> 
</body>
</html>