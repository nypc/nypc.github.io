<!DOCTYPE html>
<html>
<head>
	<title>
	</title>
	<meta name="viewport" content="width=device-width" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<style>
		h1 { margin-bottom: 20pt; font-size: 22pt; font-weight: bold; }
		h2 { margin-top: 20pt; font-size: 16pt; font-weight: bold; }
		h3 { margin-top: 20pt; font-size: 14pt; font-weight: bold; }
		blockquote { font-size: 11pt; }
		</style>
</head>
<body style='padding:20pt; font-family: 맑은 고딕;'>
<a href='./'>← 목록으로</a>
<hr>

<h1>돌도끼 만들기</h1>

<p>모바일 MMORPG ＜야생의 땅: 듀랑고＞ 에서는 플레이어들이 낯선 세상에서 생존하기 위해 필요한 물건들을 자연에서 채집하거나, 직접 만들어야 한다. 예를 들어, 다음과 같은 규칙을 따라 물건을 얻을 수 있다고 하자.</p>

<ul>
    <li>나뭇가지는 1개씩 자연에서 직접 채집할 수 있다 (에너지 10 필요)</li>
    <li>갈대는 1개씩 자연에서 직접 채집할 수 있다 (에너지 5 필요)</li>
    <li>돌은 1개씩 자연에서 직접 채집할 수 있다 (에너지 5 필요)</li>
    <li>나뭇가지 1개로 나무막대 1개를 만들 수 있다 (에너지 10 필요) </li>
    <li>돌 1개, 나무막대 1개, 갈대 2개로 돌도끼 1개를 만들 수 있다 (에너지 50 필요)</li>
</ul>

<p>이 경우 돌도끼 1개를 만드는 방법의 예를 들면 다음과 같다:</p>

<p>갈대 2개를 채집하고(에너지 5 x 2 = 10 소모), 나뭇가지 1개를 채집하여(에너지 10 소모) 나무막대 1개로 바꾸고(에너지 10 소모), 돌 1개를 채집하고(에너지 5 소모), 이 재료들로 돌도끼 1개를 만든다(에너지 50 소모). 총 에너지 소모량은 10 + 10 + 10 + 5 + 50 = 85이다.</p>

<p>물건을 얻을 수 있는 규칙들이 주어질 때, 돌도끼를 만들기 위해서는 어떤 순서로 일을 해야 하는지 구하는 프로그램을 작성하라.</p>

<h2>입력 형식</h2>

<p>첫째 줄에 물건을 얻을 수 있는 규칙의 개수를 나타내는 자연수 N (1 ≤ N ≤ 50)이 주어진다.</p>

<p>다음 N줄에 걸쳐서 물건을 만드는 규칙을 나타내는 입력이 주어진다. i번째 줄에는, i번째 규칙이 k m<sub>1</sub>  c<sub>1</sub>  m<sub>2</sub>  c<sub>2</sub> ⋯ m<sub>k</sub>  c<sub>k</sub>  E M의 형태로 주어진다. 이는 k(0 ≤ k ≤ 4)개의 재료 m<sub>1</sub>, m<sub>2</sub>, ⋯, m<sub>k</sub>를 각각 c<sub>1</sub>, c<sub>2</sub>, ⋯, c<sub>k</sub> (1 ≤ c<sub>i</sub> ≤ 10)개 사용하고 E(1 ≤ E ≤ 100)만큼의 에너지를 소모하면 M을 1개 만들 수 있다는 의미다. k = 0이면 E만큼의 에너지를 소모하여 자연에서 직접 채집할 수 있다는 의미다. k, c<sub>i</sub>, E는 모두 정수이다. M 은 알파벳 소문자로 이루어진 길이 1이상 16이하의 문자열이고, m<sub>1</sub>, m<sub>2</sub>, ⋯, m<sub>k</sub>는 반드시 이전 줄에 주어진 M중 하나이다. 같은 물건을 만드는 규칙이 여럿 주어질 수 있다.</p>

<p>주어진 M중에는 반드시 “stoneaxe”가 존재하며, 이 물건이 돌도끼를 나타낸다. 돌도끼 하나를 만드는 최적의 에너지량이 10^16이하인 입력만 주어진다.</p>

<h2>출력 형식</h2>

<p>첫째 줄에 돌도끼를 만드는 과정의 총 절차 개수 K를 첫 줄에 출력한다. K는 1이상 100이하의 자연수여야 한다.</p>

<p>다음 K줄에 걸쳐 원하는 물건을 만드는 과정을 출력하는데, 순서대로 몇 번째 규칙을 연속적으로 몇 번 사용할 것인지 공백 하나로 구분하여 출력하면 된다. 규칙을 사용하는 횟수는 1이상 10^16이하여야 한다. 또한 특정 규칙을 사용할 때는, 필요한 재료가 이미 모두 만들어져 있어야 한다.</p>

<h2>입력 예제 1</h2>


<pre>
5
0 10 branch
0 5 reed
0 5 stone
1 branch 1 10 woodstick
3 stone 1 woodstick 1 reed 2 50 stoneaxe
</pre>


<h2>출력 예제 1</h2>


<pre>
5
2 2
1 1
4 1
3 1
5 1
</pre>


<h2>입력 예제 2</h2>


<pre>
3
0 8 stone
1 stone 2 1 stone
1 stone 3 3 stoneaxe
</pre>


<h2>출력 예제 2</h2>


<pre>
2
1 3
3 1
</pre>


<h2>예제 설명</h2>
<p>예제 1은 문제 설명에서 주어진 예제와 같다.
예제 2에서 2번 규칙을 적용하면 힘들여 만든 돌의 개수를 줄이기만 하므로 쓸모가 없다. 그러므로 1번 규칙과 3번 규칙만을 이용하여 돌도끼를 만들면 된다.</p>

<h2>채점 방식</h2>

<p>입력 케이스들은 다음과 같은 종류로 구별되며, 한 종류의 케이스를 다 맞추어야 그 종류에 배정된 점수를 받을 수 있다.</p>

<ul>
    <li>종류1 (23점): 같은 물건을 만드는 규칙이 여러 번 주어지지 않는다.</li>
    <li>종류2 (77점): 문제의 원래 제한조건 이외의 추가된 제한이 없음.</li>
</ul>

<p>단, 출력에 잘못된 내용이 없고, 출력의 결과로 돌도끼가 하나 만들어 졌다면 점수의 절반을 받는다. 사용한 에너지량이 최소가 되면 전체 점수를 얻을 수 있다.</p>

<h2>해설</h2>

<p><button onclick='document.getElementById("hint_text").style.display="block"; this.style.display="none";' class='btn btn-default'>펼치기</button></p>

<div id='hint_text' style='display: none;'>
n이 작기 때문에, n번의 루프를 돌면서 각 물건을 만드는 데 드는 비용을 완화(드는 에너지가 작으면 갱신) 시킨다. 벨만-포드(Bellman-Ford) 알고리즘의 변형이라고 보면 된다. 역추적을 해야 하는 것이 까다로울 수 있는데, 각 물건마다 어떤 규칙을 사용해서 최소 에너지를 소모했는지 기록해둔 다음 위상 정렬(Topological Sort)을 통해 어떤 물건을 먼저 만들어야 하는지 순서를 알 수 있다. 그 다음은 차례대로 직접 만들어보면 된다.
</div>


</body></html>