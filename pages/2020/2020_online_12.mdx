import {
  Examples,
  Input,
  Output,
  Figure,
  PostLayout,
  Solution,
  Subtask,
} from "components";

export const meta = {
  title: "몰이 사냥",
  year: 2020,
  stage: "예선",
};

export default ({ children }) => (
  <PostLayout meta={meta}>{children}</PostLayout>
);

메이플스토리 무릉도장에서 수련을 하던 소공은 $N$ 마리의 몬스터가 있는 일자 지형 맵에 가만히 서서 몰이 사냥을 하고자 한다.
맵이 일자 지형으로 생겼으므로 맵 내 임의의 위치를 수 하나로 표현할 수 있다.
편의상 소공이 처음 맵에 입장했을 때 서있는 곳을 위치 $0$이라고 하고, 소공으로부터 오른쪽으로 거리 $d$만큼 떨어진 곳을 위치 $d$, 왼쪽으로 거리 $d$만큼 떨어진 곳을 위치 $-d$라고 하자.

맵 상 $N$ 마리의 몬스터에게 $1$부터 $N$까지 서로 다른 정수 번호가 매겨져 있다.
$i$ 번 $(1 \le i \le N)$ 몬스터는 소공이 맵에 입장했을 때 위치 $d_i$에 있으며, 그 후 매 초마다 $s_i$만큼 점프한다.
몬스터가 위치 $m$에서 $k$만큼 점프를 하면 즉시 위치 $m + k$로 이동한다.
즉, $0$ 이상의 정수 $t$에 대해 $t$ 초 후에는 위치 $(d_i+ t \times s_i)$에 있게 되는 것이다.
$s_i$가 $0$이나 음수일 수 있음에 유의하라.

소공이 스킬을 위치 $p$에 시전하면 해당 순간 위치 $p$부터 위치 $(p+R)$ 사이 범위에 있는 모든 몬스터를 잡을 수 있다.
스킬 효과 범위 양 끝에 있는 위치 $p$와 위치 $(p+R)$에 있는 몬스터 또한 잡을 수 있다.

소공은 이 스킬을 활용해서 모든 몬스터를 잡으려 한다.
소공이 몰이 사냥을 하는 방법은 맵에 입장해서 특정 시간 후 스킬을 위치 $p$에 **단 한 번** 시전하는 것이다.
$p$는 반드시 $0$ 이상 $X$ 이하의 수여야 한다.
다시 말해, 스킬은 오른쪽 방향으로 사거리 $X$ 이내에 한 번만 시전할 수 있다.

소공을 도와 모든 몬스터를 잡을 수 있는지 여부를 구해주자.

## 입력 형식

첫 줄에 스킬의 사거리와 효과 범위를 나타내는 두 정수 $X$와 $R$이 공백으로 구분되어 주어진다. $(1 \le X, R \le 1\,000\,000\,000)$

둘째 줄에 소공이 발견한 맵에 있는 몬스터의 수를 나타내는 정수 $N$이 입력으로 주어진다. $(1 \le N \le 100\,000)$

셋째 줄부터 각 줄에 몬스터 $i$의 초기 위치와 점프하는 정도를 나타내는 두 정수 $d_i$와 $s_i$가 공백으로 구분되어 입력으로 주어진다. $(-1\,000\,000\,000 \le d_i, s_i \le 1\,000\,000\,000)$

## 출력 형식

소공이 스킬을 단 한 번 시전해 모든 몬스터를 잡을 수 있으면 첫 줄에 `T` 잡을 수 없으면 `F`를 출력한다.

## 예제 1

<Examples>
  {/* prettier-ignore */}
  <Input>
3 2
3
-1 1
7 -3
3 0
  </Input>
  {/* prettier-ignore */}
  <Output>
T
  </Output>
</Examples>

## 예제 2

<Examples>
  {/* prettier-ignore */}
  <Input>
4 3
3
12 1
10 1
15 2
  </Input>
  {/* prettier-ignore */}
  <Output>
F
  </Output>
</Examples>

## 채점 방식

입력 케이스들은 다음과 같은 종류로 구별되며, 한 종류의 케이스를 다 맞추어야 그 종류에 배정된 점수를 받을 수 있다.

<Subtask index={1} score={41}>
  $N, X, R \le 5\,000$; $-5\,000 \le d_i, s_i \le 5\,000$
</Subtask>
<Subtask index={2} score={59}>
  추가적인 제한 조건이 없음.
</Subtask>

## 해설

<Solution>

$$
f(t, i, j) = t\textrm{초 후에 임의의 몬스터 }i, j\textrm{의 거리 차이}
$$

라고 정의하면 V 형태의 그래프가 나오는데,

$$
q(t) = t\textrm{초 후의 가장 먼 몬스터의 거리}
$$

로 정의하면 $q(t) = \max f(t,i,j)$가 되고, 아래로 볼록한 함수임을 알 수 있다. 모든 몬스터가 위치 $0$이상 $X+R$이하에 존재하는 시간에 대해 임의의 두 몬스터의 거리의 최대의 최소값을 삼분탐색(ternary search)을 통해 알 수 있고, 해당 최소값이 $R$이하인지 판단하면 된다.

</Solution>
