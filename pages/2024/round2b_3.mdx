import {
  Examples,
  Input,
  Output,
  Figure,
  PostLayout,
  Simulators,
  Solution,
  Subtask,
} from "components";

export const meta = {
  title: "점 짝짓기",
  year: 2024,
  stage: "Round 2-B",
};

export default ({ children }) => (
  <PostLayout meta={meta}>{children}</PostLayout>
);

# 점 짝짓기

2차원 평면에 $N$ 개의 점이 주어진다. $N$은 짝수이다.
점들은 $1$번부터 $N$번까지 번호가 매겨져 있다.
$i$번 점의 좌표는 $(x_i, y_i)$이다.
점들을 두 개씩 짝을 지어 $\frac{N}{2}$ 개의 쌍을 만들려고 한다.
두 점 $(x_i, y_i)$과 $(x_j, y_j)$가 짝이 되었을 때 이 쌍에 대한 점수는
$|x_i-x_j|+|y_i-y_j|$이다.

점수 총합이 가능한 최대가 되도록 점을 짝짓는 프로그램을 작성하라.

## 입력 형식

첫 줄에 점의 수를 나타내는 정수 $N$이 주어진다.
($2 \le N \le 200\,000;$ $N$은 짝수)

이어지는 $N$ 개의 줄의 $i$ 번째 줄에는
$i$번 점의 좌표를 나타내는 두 정수 $x_i$, $y_i$가
공백으로 구분되어 주어진다.
($-1\,000\,000\,000 \le x_i, y_i \le 1\,000\,000\,000$)

## 출력 형식

첫 줄에 점수 총합의 최댓값을 출력한다.

그다음 $\frac{N}{2}$ 개의 줄에 걸쳐 최대 점수 총합을 만드는
짝짓기 방법을 출력한다.
각 줄은 짝을 짓는 두 점의 번호를 공백으로 구분하여 출력한다.

만약 가능한 답이 여러 가지라면, 그중 아무거나 하나 출력한다.

## 예제

<Examples>
  {/* prettier-ignore */}
  <Input>
4
1 2
2 1
2 2
1 1
  </Input>
  {/* prettier-ignore */}
  <Output>
4
4 3
1 2
  </Output>
</Examples>

## 예제 설명

$4$번 점과 $3$번 점으로 쌍을 만들어 $2$점을 얻고, $1$번 점과 $2$번 점으로 쌍을 만들어
$2$점을 얻는다. 점수의 총합은 $4$점이다.

## 채점 방식

입력 케이스들은 다음과 같은 종류로 구별되며, 한 종류의 케이스를 다 맞혀야 그 종류에 배정된 점수를 받을 수 있다.

<Subtask index={1} score={19}>
  $N \le 16$
</Subtask>
<Subtask index={2} score={18}>
  모든 점의 $y$ 좌표가 같음.
</Subtask>
<Subtask index={3} score={63}>
  추가적인 제한 조건이 없음.
</Subtask>

## 해설

<Solution>
아래 설명은 편의를 위해 각각의 $x$, $y$ 좌표가 다르다고 가정한다.
실제로 중복된 좌표가 있더라도 이들을 서로 다른 값으로 취급하여도
풀이는 여전히 유효하다.

우선, $x$ 좌표만 있는 1차원의 경우를 생각하자.
편의상 $x_1 \le x_2$라고 할 때, 두 점 $x_1$와 $x_2$를 짝지으면
점수는 $|x_1-x_2| = x_2-x_1$이다.
즉, 큰 좌표에 $1$을, 작은 좌표에 $-1$을 곱한 값이 점수가 된다.
이렇게 $\frac{N}{2}$ 개의 짝을 만든다면 각각의 좌표에 곱할 수 있는 $1$과 $-1$이 각각 $\frac{N}{2}$ 개 생긴다.

실제로 점을 짝짓는 방법을 생각하기 전에 이상적으로 점수를 최대화하는 방법만 생각하자.
좌표 $x_1$에 $1$, $x_2$에 $-1$이 곱해져 있는데 $x_1 < x_2$이면, 곱해진 값을 교환하면 반드시 점수에 이득이 된다.

이 과정을 최대한 반복하자.
그러면 결국 좌표를 정렬했을 때 큰 좌표 $\frac{N}{2}$ 개에 $1$을,
작은 좌표 $\frac{N}{2}$ 개에 $-1$을 곱한 상황에 수렴하고 더 이상 교환이 불가능하다.
이 상황이 최대 점수가 되며, 실제로 점을 짝짓는 방법도 쉽게 알 수 있다.
큰 좌표를 가지는 점들과 작은 좌표를 가지는 점들을 일대일로 짝짓는 것이다.

이제 $x$ 좌표와 $y$ 좌표가 있는 2차원의 경우를 생각하자.
비슷한 논리를 사용하면 이상적으로 점수를 최대화하는 방법은
$x$, $y$좌표 각각에 대해 큰 좌표 $\frac{N}{2}$ 개에 $1$을 곱하고,
작은 좌표 $\frac{N}{2}$ 개에 $-1$을 곱하는 것이다.
이것이 가능하게 점들을 짝지을 수 있을까?

$x$ 좌표와 $y$ 좌표 각각에 대해 큰 좌표 $\frac{N}{2}$ 개와
작은 좌표 $\frac{N}{2}$ 개를 반으로 나눌 수 있도록
$xy$평면을 4분할 해보자.
이때 1사분면에 $p$ 개의 점이 들어있다면
2사분면과, 4사분면에는 $N-p$ 개,
3사분면에는 $p$개의 점이 들어있게 된다.

1사분면과 3사분면에 들어있는 점들을 일대일로 짝짓고,
2사분면과 4사분면에 들어있는 점들을 일대일로 짝지으면 이것이 이상적으로 점수를 최대화하는 방법을 구현한다는 것을 알 수 있다.
</Solution>
