import {
  Examples,
  Input,
  Output,
  Figure,
  PostLayout,
  Solution,
  Subtask,
} from "components";

export const meta = {
  title: "메이플스토리 파티 구성",
  year: 2019,
  stage: "예선",
};

export default ({ children }) => (
  <PostLayout meta={meta}>{children}</PostLayout>
);

$2003$년 $4$월 $29$일 출시한 메이플스토리는 올해 $16$주년을 맞이했다. $16$년 동안 게임이 이어져 오면서 현재에는 아주 많은 캐릭터 직업이 있다.

창수가 운영하는 길드에는 총 $N$명의 길드원이 있다. 편의상 길드원들에게 $1$번부터 $N$번까지 번호가 매겨져 있다. 이 길드의 주된 목적은 길드원들끼리 파티를 구성해서 검은 마법사를 격파하는 것인데, 이때 파티에서 제일 중요한 요소는 파티 안에 있는 캐릭터 직업 구성이다.

창수는 길드를 운영하면서 어떤 캐릭터 직업 구성이 검은 마법사를 격파하기 좋은지 매번 새로운 시도를 하려 한다. 그 때문에 파티를 구성할 때마다 이전과 다른 캐릭터 직업 구성이길 바라는데, 창수가 제일 힘들어하는 부분이 두 개의 파티가 있을 때 캐릭터 직업 구성이 같은지 확인하는 것이다.

여기서, 파티의 캐릭터 직업 구성이란 파티 안에 있는 서로 다른 캐릭터 직업의 조합을 의미한다.

예를 들어 히어로 $3$명, 아란 $2$명, 호영 $4$명으로 구성된 파티는 히어로 $2$명, 아란 $3$명, 호영 $5$명으로 구성된 파티와 히어로, 아란, 호영으로 구성되어 있다는 점에서 캐릭터 직업 구성이 같다. 그러나 히어로 $2$명, 다크나이트 $1$명, 호영 $7$명으로 구성된 파티와는 캐릭터 직업 구성이 다르다.

창수의 친한 친구인 당신은 창수의 고민을 듣고 창수를 최대한 도와주려고 한다. 길드 내에서 구성할 수 있는 두 개의 파티 구성이 있을 때, 파티에 있는 캐릭터 직업의 구성이 같은지 판별하는 프로그램을 작성하시오.

## 입력 형식

첫 줄에 길드원의 수 $N$과 질문의 수 $Q$가 공백으로 구분되어 주어진다. ($1 \le N, Q \le 100\,000$)

그 다음 줄에 $N$개의 자연수가 공백으로 구분되어 주어지는데, $i$번째로 주어지는 수는 $i$번 길드원의 캐릭터 직업을 의미한다. 캐릭터 직업을 나타내는 자연수는 $N$ 보다 크지 않다.

그 다음 $Q$개의 줄에 걸쳐 질문에 대한 정보가 주어지는데, `a b c d`의 형태로 주어진다.

이는 `a`번 길드원부터 `b`번 길드원까지 구성된 파티가 `c`번 길드원부터 `d`번 길드원까지 구성된 파티와 캐릭터 직업 구성이 같은지 묻는 질문을 의미한다. 이때, 같은 길드원이 여러 파티에 들어갈 수 있음에 유의하라. ($1 \le a, b, c, d \le N$; $a \le b$; $c \le d$)

## 출력 형식

$Q$개의 줄에 걸쳐 입력으로 들어온 질문에 대해 순서대로 답을 `YES` 혹은 `NO`로 출력한다.

## 예제

<Examples>
  {/* prettier-ignore */}
  <Input>
    10 6
    3 1 1 3 4 3 3 1 1 2
    1 3 2 4
    5 6 6 7
    5 7 4 6
    2 4 6 9
    1 10 1 10
    1 9 9 10
  </Input>
  {/* prettier-ignore */}
  <Output>
    YES
    NO
    YES
    YES
    YES
    NO
  </Output>
</Examples>

## 채점 방식

입력 케이스들은 다음과 같은 종류로 구별되며, 한 종류의 케이스를 다 맞추어야 그 종류에 배정된 점수를 받을 수 있다.

<Subtask index={1} score={7}>
  $N, Q \le 5\,000$
</Subtask>
<Subtask index={2} score={23}>
  $N \le 5\,000$
</Subtask>
<Subtask index={3} score={21}>
  캐릭터 직업을 나타내는 수 $\le 64$
</Subtask>
<Subtask index={4} score={49}>
  별다른 제약조건 없음.
</Subtask>

## 해설

<Solution>

특정 구간에 있는 캐릭터의 직업 구성이 같은 지 확인하기 위해 구간에 있는
캐릭터의 직업 구성을 해시값으로 표현한다. 서로 다른 두 구간에 대해 이렇게
계산된 해시값을 단순 비교하는 것으로 구성이 같은 지 확인할 수 있다.

문제에서 해시값을 계산해야 하는 구간의 개수가 $2M$개다. 그리고 구해야 하는 것은 캐릭터의
직업 구성이므로 누적 배열 같은 것으로 간단히 해시값을 계산할 수 없다. 이
해시값을 계산하기 위해 Mo’s algorithm을 응용하여, 해시값을 계산할 구간의
순서를 잘 정한 뒤, 구간마다 해시값을 모두 구하는 과정을 전체 시간복잡도
$\mathcal{O}(N^{1.5})$에 마칠 것이다. 이렇게 계산된 해시값을 이용하여 문제를 간단하게 해결할
수 있다. 해시의 충돌 가능성을 줄이려면 이중 혹은 삼중 해싱을 하면 좋다.

</Solution>
